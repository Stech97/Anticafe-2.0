<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <targets>
    <target xsi:type="File" name="Trace" fileName="C:/Log/Anticafe/Trace_${shortdate}.log"
                  layout="${longdate} ${uppercase:${level}} ${message}" />
    <target xsi:type="File" name="Error" fileName="C:/Log/Anticafe/Exception_${shortdate}.log"
              layout="${longdate} ${uppercase:${level}} ${message}" />
			  
	<target name="database" xsi:type="Database" connectionstring="Server=localhost;Database=NLog;Trusted_Connection=True;">
		<commandText>
			INSERT INTO Exceptions ([LogLevel],[message],[CreatedOn],[OrderId]) VALUES (@Origin,@Message,@LogLevel,@Date, @OrderId);
		</commandText>
		<parameter name="@Date" layout="${date}" dbType="DbType.Date"/>
		<parameter name="@LogLevel" layout="${level}"/>
		<parameter name="@message" layout="${message}"/>
		<parameter name="@OrderId" layout="${event-properties:MyOrderId}" dbType="DbType.Int32"/> <!-- custom field! Note also the DB Type. Using Logger.WithProperty -->

	</target>
			  
			  
  </targets>

  <rules>
    <logger name="*" levels="Trace,Debug,Info,Warn" writeTo="Trace" />
    <logger name="*" minlevel="Error" writeTo="Error, database" />
  </rules>
</nlog>
